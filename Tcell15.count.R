countFilter=20      #???????????ÐµÄ¼???Öµ???Ú»????? 20
inputFile="string_interactions_short.tsv"            #?????Ä¼?(??????Ïµ?Ä¼?)
setwd("D:\\Nature\\CD8\\CD8\\15.PPI")     #???Ã¹???Ä¿Â¼

#??È¡?????Ä¼?
rt=read.table(inputFile, header=T, sep="\t", check.names=FALSE, comment.char="")
tb=table(c(as.vector(rt[,1]), as.vector(rt[,2])))#tb ????Ò»??????Á½?ÐµÄ±????????Ðµ?Ò»?Ð°?????Ò»?????Ýµ?Î¨Ò»Öµ???Ú¶??Ð°????Ú¶??????Ýµ?Î¨Ò»Öµ??????Ê¾???ÇµÄ³??Ö´???
tb=sort(tb, decreasing=T)#??Ö®Ç°?????Ä±??? tb ???????????????????Õ½??ò£¨µÝ¼?Ë³???????????Ð±???????

#???????????Ä»???
outTab=as.data.frame(tb)#as.data.frame() ??R?????Ðµ?Ò»???????????Ú½????????????Í£??????ñ¡¢¾????È£?×ª??Îª???Ý¿?
outTab=outTab[outTab[,2]>=countFilter,]#[outTab[, 2] >= countFilter, ] ??Ò»??????É¸Ñ¡??????????Ä¿????Ñ¡?????Ú¶????Ðµ?Öµ???Ú»????? countFilter ???Ð¡?
colnames(outTab)=c("Gene","Count")#colnames(outTab) = c("Gene", "Count") ?â²¿?Ö´??ë½«Ö®Ç°??È¡???????æ»»Îª?Âµ?????????????Ò»?Ðµ????Æ½???????Îª "Gene"???Ú¶??Ðµ????Æ½???????Îª "Count"
write.table(outTab,file="hubGene.txt",sep="\t",quote=F,row.names=F)
showNum=nrow(outTab)#nrow() ??R?????Ðµ?Ò»???????????Ú»?È¡???Ý¿????????????????????Ý¿??ÐµÄ¼?Â¼??Á¿??,Í¨??Ö´?????Ð´??ë£¬???????? showNum ??Á¿?ÐµÃµ? outTab ???Ý¿?????????
n=as.matrix(tb)[1:showNum,]#as.matrix(tb) ?????? tb ×ª??ÎªÒ»??????????????Îª?????Í¾????Ç²?Í¬?????Ý½á¹¹????Ê±??Òª??????×ª??Îª??Í¬?????Ý½á¹¹?Ô½????Ø¶??Ä²???

#????Ò»??Ë®Æ½????Í¼??horizontal bar plot??
pdf(file="barplot.pdf", width=8, height=8)
par(mar=c(5,6,1,2),xpd=T)
bar=barplot(n,horiz=TRUE,col="skyblue",names=FALSE,xlim=c(0,ceiling(max(n)/5)*5),xlab="Number of adjacent nodes")
text(x=n*0.935,y=bar,n)     #??Í¼???Ð¼????Ú½Ó½Úµ???Ä¿
text(x=-0.2,y=bar,label=names(n),xpd=T,pos=2)     #??Í¼???Ð¼??Ï»?????????
dev.off()


######??????